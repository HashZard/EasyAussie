<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
    <meta name="color-scheme" content="light only"/>
    <meta name="permission" content="required">
    <title>租房申请 - Easy Aussie</title>
    <meta name="description" content="填写详细的租房申请信息，提高申请成功率"/>
    <script type="module" src="/src/main.ts"></script>
    <script type="module">
        import { MobileHeaderComponent } from '/src/components/mobile-header.ts';
        import { MobileFooterComponent } from '/src/components/mobile-footer.ts';
        import { notificationService } from '/src/services/notification-service.ts';
        import { httpClient } from '/src/services/http-client.ts';
        import { authStore } from '/src/stores/auth-store.ts';

        document.addEventListener('DOMContentLoaded', () => {
            new MobileHeaderComponent();
            new MobileFooterComponent();
            
            // 权限检查
            authStore.requireRole('paid2').catch(() => {
                // 权限不足会自动跳转
            });

            initApplicationForm();
        });

        function initApplicationForm() {
            const form = document.getElementById('applicationForm');
            
            // 表单提交
            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                await submitForm();
            });

            // 文件上传预览
            setupFilePreview();
            
            // 添加/删除功能
            setupAddRemoveButtons();
            
            // 自动保存功能
            setupAutoSave();
        }

        function setupFilePreview() {
            const fileInputs = document.querySelectorAll('input[type="file"]');
            fileInputs.forEach(input => {
                input.addEventListener('change', (e) => {
                    const files = e.target.files;
                    const previewId = input.getAttribute('data-preview');
                    
                    if (previewId) {
                        updateFilePreview(previewId, files);
                    }
                });
            });
        }

        function updateFilePreview(previewId, files) {
            const previewContainer = document.getElementById(previewId);
            if (!previewContainer) return;
            
            previewContainer.innerHTML = '';
            
            Array.from(files).forEach((file, index) => {
                const li = document.createElement('li');
                li.className = 'flex items-center justify-between bg-gray-50 p-2 rounded';
                li.innerHTML = `
                    <span class="text-sm text-gray-700 truncate">${file.name}</span>
                    <span class="text-xs text-gray-500">${(file.size / 1024).toFixed(1)}KB</span>
                `;
                previewContainer.appendChild(li);
            });
        }

        function setupAddRemoveButtons() {
            // 居住历史
            document.getElementById('addRentalHistory').addEventListener('click', () => {
                addRentalHistory();
            });

            // 工作经历
            document.getElementById('addWorkHistory').addEventListener('click', () => {
                addWorkHistory();
            });
        }

        function addRentalHistory() {
            const container = document.getElementById('rentalHistoryList');
            const count = container.children.length;
            
            if (count >= 5) {
                notificationService.warning('最多只能添加5条居住历史');
                return;
            }

            const item = createRentalHistoryItem(count);
            container.appendChild(item);
            notificationService.success('已添加居住历史');
        }

        function addWorkHistory() {
            const container = document.getElementById('workHistoryList');
            const count = container.children.length;
            
            if (count >= 3) {
                notificationService.warning('最多只能添加3条工作经历');
                return;
            }

            const item = createWorkHistoryItem(count);
            container.appendChild(item);
            notificationService.success('已添加工作经历');
        }

        function createRentalHistoryItem(index) {
            const div = document.createElement('div');
            div.className = 'bg-gray-50 p-4 rounded-lg space-y-4 relative';
            div.innerHTML = `
                <button type="button" class="absolute top-2 right-2 text-red-500 hover:text-red-700" onclick="removeItem(this)">
                    <i class="fas fa-times"></i>
                </button>
                <input type="text" name="rentalAddress[]" placeholder="租房地址" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <select name="rentalType[]" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <option value="">选择租房类型</option>
                        <option value="学生公寓">学生公寓</option>
                        <option value="房东直租">房东直租</option>
                        <option value="中介租房">中介租房</option>
                        <option value="其他">其他(无合同)</option>
                    </select>
                    <input type="text" name="rentalNote[]" placeholder="备注" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div class="flex items-center space-x-2">
                        <input type="month" name="rentalStart[]" class="flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <span class="text-gray-500">至</span>
                        <input type="month" name="rentalEnd[]" class="flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    <input type="text" name="rentalPrice[]" placeholder="租金 (如: 250/week)" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <input type="text" name="rentalContactName[]" placeholder="联系人姓名" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    <input type="text" name="rentalContactRelation[]" placeholder="联系人身份" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    <input type="tel" name="rentalContactPhone[]" placeholder="联系人电话" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    <input type="email" name="rentalContactEmail[]" placeholder="联系人邮箱" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">租房合同</label>
                        <input type="file" name="rental_agreement[]" class="w-full p-2 border border-gray-300 rounded-lg text-sm">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">租金支付记录</label>
                        <input type="file" name="rental_ledger[]" class="w-full p-2 border border-gray-300 rounded-lg text-sm">
                    </div>
                </div>
            `;
            return div;
        }

        function createWorkHistoryItem(index) {
            const div = document.createElement('div');
            div.className = 'bg-gray-50 p-4 rounded-lg space-y-4 relative';
            div.innerHTML = `
                <button type="button" class="absolute top-2 right-2 text-red-500 hover:text-red-700" onclick="removeItem(this)">
                    <i class="fas fa-times"></i>
                </button>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <input type="text" name="companyName[]" placeholder="公司名称" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    <input type="text" name="companyAddress[]" placeholder="公司地址" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    <input type="text" name="jobPosition[]" placeholder="职位" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    <input type="text" name="income[]" placeholder="收入情况" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div class="flex items-center space-x-2">
                        <input type="month" name="workStart[]" class="flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <span class="text-gray-500">至</span>
                        <input type="month" name="workEnd[]" class="flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    </div>
                    <input type="text" name="supervisor_name[]" placeholder="证明人姓名" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    <input type="text" name="supervisor_position[]" placeholder="证明人职位" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    <input type="tel" name="supervisor_phone[]" placeholder="证明人电话" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    <input type="email" name="supervisor_email[]" placeholder="证明人邮箱" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">近期3张工资单</label>
                    <input type="file" name="pay_slips[]" multiple class="w-full p-2 border border-gray-300 rounded-lg text-sm">
                </div>
            `;
            return div;
        }

        window.removeItem = function(button) {
            button.closest('.bg-gray-50').remove();
            notificationService.info('已删除项目');
        };

        function setupAutoSave() {
            const form = document.getElementById('applicationForm');
            const inputs = form.querySelectorAll('input[type="text"], input[type="email"], input[type="tel"], input[type="date"], input[type="month"], select, textarea');
            
            inputs.forEach(input => {
                input.addEventListener('change', () => {
                    const key = `application_${input.name}`;
                    localStorage.setItem(key, input.value);
                });
            });

            // 加载保存的数据
            inputs.forEach(input => {
                const key = `application_${input.name}`;
                const saved = localStorage.getItem(key);
                if (saved && !input.value) {
                    input.value = saved;
                }
            });
        }

        async function submitForm() {
            const form = document.getElementById('applicationForm');
            const formData = new FormData(form);
            
            try {
                notificationService.loading('正在提交租房申请...');
                
                const response = await httpClient.post('/api/form-submit', formData);
                
                notificationService.success('申请提交成功！我们会尽快处理您的申请。');
                
                // 清除自动保存的数据
                Object.keys(localStorage).forEach(key => {
                    if (key.startsWith('application_')) {
                        localStorage.removeItem(key);
                    }
                });
                
                setTimeout(() => {
                    window.location.href = '/pages/submit-success.html';
                }, 2000);
            } catch (error) {
                console.error('Submit error:', error);
                notificationService.error('提交失败，请重试或联系客服');
            }
        }
    </script>
</head>

<body class="bg-gray-50 text-gray-900" data-required-role="paid2">
<div id="header"></div>

<main class="flex-grow py-6">
    <div class="max-w-4xl mx-auto px-4">
        <!-- 页面标题 -->
        <div class="bg-white rounded-xl p-6 shadow-sm mb-6">
            <h1 class="text-xl sm:text-2xl font-bold text-center mb-4">租房申请信息填写</h1>
            <p class="text-gray-600 text-center text-sm">请详细填写申请信息，我们将协助您准备完整的租房申请材料</p>
        </div>

        <form id="applicationForm" class="space-y-6">
            <input type="hidden" name="formType" value="rentalApplication"/>
            
            <!-- 基本信息 -->
            <div class="bg-white rounded-xl p-6 shadow-sm">
                <h2 class="text-lg font-semibold mb-4">一、基本信息</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">姓名 *</label>
                        <input type="text" name="name" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"/>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">邮箱 *</label>
                        <input type="email" name="email" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"/>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">学校</label>
                        <input type="text" name="uniName" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"/>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">专业</label>
                        <input type="text" name="major" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"/>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">电话 *</label>
                        <input type="tel" name="phone" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"/>
                    </div>
                </div>
            </div>

            <!-- 租房需求 -->
            <div class="bg-white rounded-xl p-6 shadow-sm">
                <h2 class="text-lg font-semibold mb-4">二、租房需求</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">预算(每周)</label>
                        <input type="text" name="budget" placeholder="如：$200-300" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"/>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">房型需求</label>
                        <select name="room_type" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="">请选择</option>
                            <option value="studio">Studio</option>
                            <option value="shared">Shared Room</option>
                            <option value="single">Single Room</option>
                            <option value="master">Master Room</option>
                            <option value="entire">整套房子</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">期望区域</label>
                        <input type="text" name="preferred_area" placeholder="如：Clayton, Box Hill, CBD等" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"/>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">租期长度</label>
                        <select name="lease_length" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="">请选择</option>
                            <option value="short">短租(1-3个月)</option>
                            <option value="medium">中租(3-6个月)</option>
                            <option value="long">长租(6个月以上)</option>
                            <option value="flexible">灵活</option>
                        </select>
                    </div>
                </div>
                <div class="mt-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">其他要求</label>
                    <textarea name="requirements" rows="3" placeholder="如：需要家具、需要停车位、宠物友好等" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                </div>
            </div>

            <!-- 收入证明 -->
            <div class="bg-white rounded-xl p-6 shadow-sm">
                <h2 class="text-lg font-semibold mb-4">三、收入证明</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">收入类型</label>
                        <select name="income_type" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="">请选择</option>
                            <option value="part_time">Part-time Job</option>
                            <option value="full_time">Full-time Job</option>
                            <option value="casual">Casual Job</option>
                            <option value="student_support">学生津贴</option>
                            <option value="family_support">家庭支持</option>
                            <option value="other">其他</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">每周收入</label>
                        <input type="text" name="weekly_income" placeholder="如：$500" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"/>
                    </div>
                </div>
                
                <div class="mt-4 space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">银行流水(3个月)</label>
                        <input type="file" name="bank_statement" multiple data-preview="bankPreview" class="w-full p-2 border border-gray-300 rounded-lg text-sm file:mr-2 file:py-2 file:px-4 file:rounded file:border-0 file:bg-blue-50 file:text-blue-700"/>
                        <ul id="bankPreview" class="mt-2 space-y-1"></ul>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">身份证明(护照/ID)</label>
                        <input type="file" name="id_document" data-preview="idPreview" class="w-full p-2 border border-gray-300 rounded-lg text-sm file:mr-2 file:py-2 file:px-4 file:rounded file:border-0 file:bg-blue-50 file:text-blue-700"/>
                        <ul id="idPreview" class="mt-2 space-y-1"></ul>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">学生签证</label>
                        <input type="file" name="student_visa" data-preview="visaPreview" class="w-full p-2 border border-gray-300 rounded-lg text-sm file:mr-2 file:py-2 file:px-4 file:rounded file:border-0 file:bg-blue-50 file:text-blue-700"/>
                        <ul id="visaPreview" class="mt-2 space-y-1"></ul>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">在读证明</label>
                        <input type="file" name="enrollment_certificate" data-preview="enrollmentPreview" class="w-full p-2 border border-gray-300 rounded-lg text-sm file:mr-2 file:py-2 file:px-4 file:rounded file:border-0 file:bg-blue-50 file:text-blue-700"/>
                        <ul id="enrollmentPreview" class="mt-2 space-y-1"></ul>
                    </div>
                </div>
            </div>

            <!-- 工作经历 -->
            <div class="bg-white rounded-xl p-6 shadow-sm">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-lg font-semibold">四、工作经历</h2>
                    <button type="button" id="addWorkHistory" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 text-sm">
                        <i class="fas fa-plus mr-1"></i>添加工作经历
                    </button>
                </div>
                <div id="workHistoryList" class="space-y-4">
                    <!-- 工作经历项目会在这里动态添加 -->
                </div>
            </div>

            <!-- 居住历史 -->
            <div class="bg-white rounded-xl p-6 shadow-sm">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-lg font-semibold">五、居住历史</h2>
                    <button type="button" id="addRentalHistory" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 text-sm">
                        <i class="fas fa-plus mr-1"></i>添加居住历史
                    </button>
                </div>
                <div id="rentalHistoryList" class="space-y-4">
                    <!-- 居住历史项目会在这里动态添加 -->
                </div>
            </div>

            <!-- 紧急联系人 -->
            <div class="bg-white rounded-xl p-6 shadow-sm">
                <h2 class="text-lg font-semibold mb-4">六、紧急联系人</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">联系人姓名 *</label>
                        <input type="text" name="emergency_name" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"/>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">与您的关系 *</label>
                        <input type="text" name="emergency_relation" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"/>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">联系电话 *</label>
                        <input type="tel" name="emergency_phone" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"/>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">邮箱</label>
                        <input type="email" name="emergency_email" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"/>
                    </div>
                </div>
            </div>

            <!-- 其他信息 -->
            <div class="bg-white rounded-xl p-6 shadow-sm">
                <h2 class="text-lg font-semibold mb-4">七、其他信息</h2>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">是否有宠物？</label>
                        <div class="flex space-x-4">
                            <label class="flex items-center">
                                <input type="radio" name="has_pets" value="yes" class="mr-2"/>
                                <span>是</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="has_pets" value="no" class="mr-2"/>
                                <span>否</span>
                            </label>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">是否有车？</label>
                        <div class="flex space-x-4">
                            <label class="flex items-center">
                                <input type="radio" name="has_car" value="yes" class="mr-2"/>
                                <span>是</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="has_car" value="no" class="mr-2"/>
                                <span>否</span>
                            </label>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">是否吸烟？</label>
                        <div class="flex space-x-4">
                            <label class="flex items-center">
                                <input type="radio" name="is_smoker" value="yes" class="mr-2"/>
                                <span>是</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="is_smoker" value="no" class="mr-2"/>
                                <span>否</span>
                            </label>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">其他说明</label>
                        <textarea name="additional_info" rows="4" placeholder="请提供任何其他相关信息，这将有助于我们更好地为您服务" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                    </div>
                </div>
            </div>

            <!-- 提交按钮 -->
            <div class="bg-white rounded-xl p-6 shadow-sm">
                <div class="flex flex-col sm:flex-row gap-4">
                    <button type="submit" class="flex-1 bg-blue-500 text-white py-4 px-6 rounded-lg hover:bg-blue-600 font-medium text-lg">
                        <i class="fas fa-paper-plane mr-2"></i>提交租房申请
                    </button>
                    <button type="button" onclick="window.history.back()" class="flex-1 bg-gray-500 text-white py-4 px-6 rounded-lg hover:bg-gray-600 font-medium text-lg">
                        <i class="fas fa-arrow-left mr-2"></i>返回
                    </button>
                </div>
                
                <div class="mt-4 text-center">
                    <p class="text-xs text-gray-500">
                        提交申请后，我们的专业团队将在24小时内联系您，协助您完成租房申请流程
                    </p>
                </div>
            </div>
        </form>
    </div>
</main>

<div id="footer"></div>

<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"/>
</body>
</html>

            <!-- 居住历史 -->
            <div class="ea-section" id="rentalHistoryContainer" data-limit="5">
                <h3 class="ea-section-title">二、居住历史(近三年)</h3>
                <div class="form-clone-wrapper space-y-4">
                    <div class="form-entry relative space-y-4 border border-gray-300 p-4 rounded-md">
                        <!-- 第一行：房产地址 -->
                        <div class="grid grid-cols-1">
                            <label class="ea-label">租房地址：
                                <input type="text" name="rentalAddress[]" class="ea-input w-full mt-2"/>
                            </label>
                        </div>

                        <!-- 第二行：租房类型 + 备注 -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="ea-inline-field">
                                <label class="ea-inline-label">租房类型：</label>
                                <select name="rentalType[]" class="ea-select w-32">
                                    <option value="学生公寓">学生公寓</option>
                                    <option value="房东直租">房东直租</option>
                                    <option value="中介租房">中介租房</option>
                                    <option value="其他">其他(无合同)</option>
                                </select>
                            </div>
                            <div class="ea-inline-field">
                                <label class="ea-inline-label">备注：</label>
                                <input type="text" name="rentalNote[]" class="ea-input"
                                       placeholder="如：二房东、合租等"/>
                            </div>
                        </div>

                        <!-- 第三行：居住时间 + 租金 -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="ea-inline-field">
                                <label class="ea-inline-label">居住时间：</label>
                                <input type="month" name="rentalStart[]" class="ea-input w-32"/>
                                <span class="mx-2">至</span>
                                <input type="month" name="rentalEnd[]" class="ea-input w-32"/>
                            </div>
                            <div class="ea-inline-field">
                                <label class="ea-inline-label">租金：</label>
                                <input type="text" name="rentalPrice[]" class="ea-input"
                                       placeholder="如 250/week"/>
                            </div>
                        </div>

                        <!-- 第四行：地址联系人 -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <label class="ea-label">联系人姓名：
                                <input type="text" name="rentalContactName[]" class="ea-input"/>
                            </label>
                            <label class="ea-label">联系人身份:
                                <input type="text" name="rentalContactRelation[]" class="ea-input"
                                       placeholder="如：房东、室友等"/>
                            </label>
                            <label class="ea-label">联系人电话:
                                <input type="tel" name="rentalContactPhone[]" class="ea-input"/>
                            </label>
                            <label class="ea-label">联系人邮箱:
                                <input type="email" name="rentalContactEmail[]" class="ea-input"/>
                            </label>
                            <label class="ea-label">租房合同：
                                <input type="file" name="rental_agreement[]" class="ea-input"/>
                            </label>
                            <label class="ea-label">租金支付记录：
                                <input type="file" name="rental_ledger[]" class="ea-input"/>
                            </label>
                        </div>
                    </div>
                </div>
                <button type="button" class="ea-add-btn text-blue-600 hover:underline"
                        data-target="#rentalHistoryContainer">➕ 增加历史居住信息
                </button>
            </div>

            <!-- 推荐人信息 -->
            <div class="ea-section">
                <h3 class="ea-section-title">三、推荐人信息</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <label class="ea-label">姓名 (Reference1)：
                        <input type="text" name="referee_name_1" class="ea-input"/>
                    </label>
                    <label class="ea-label">电话：
                        <input type="tel" name="referee_phone_1" class="ea-input"/>
                    </label>
                    <label class="ea-label">邮箱：
                        <input type="email" name="referee_email_1" class="ea-input"/>
                    </label>
                    <label class="ea-label">与租客关系：
                        <input type="text" name="referee_relation_1" class="ea-input"/>
                    </label>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                    <label class="ea-label">姓名 (Reference2)：
                        <input type="text" name="referee_name_2" class="ea-input"/>
                    </label>
                    <label class="ea-label">电话：
                        <input type="tel" name="referee_phone_2" class="ea-input"/>
                    </label>
                    <label class="ea-label">邮箱：
                        <input type="email" name="referee_email_2" class="ea-input"/>
                    </label>
                    <label class="ea-label">与租客关系：
                        <input type="text" name="referee_relation_2" class="ea-input"/>
                    </label>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                    <label class="ea-label">姓名 (紧急联系人)：
                        <input type="text" name="emergency_name_1" class="ea-input"/>
                    </label>
                    <label class="ea-label">电话：
                        <input type="tel" name="emergency_phone_2" class="ea-input"/>
                    </label>
                    <label class="ea-label">邮箱：
                        <input type="email" name="emergency_email_2" class="ea-input"/>
                    </label>
                    <label class="ea-label">与租客关系：
                        <input type="text" name="emergency_relation_2" class="ea-input"/>
                    </label>
                </div>
            </div>

            <!-- 申请材料 -->
            <div class="ea-section">
                <h3 class="ea-section-title">四、申请材料</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <label class="ea-label">护照（Passport）：
                        <input type="file" name="passport" required class="ea-input"/>
                    </label>
                    <label class="ea-label">签证（Visa）：
                        <input type="file" name="visa" required class="ea-input"/>
                    </label>
                    <div>
                        <div class="ea-label">存款证明（Proof of Balance）：</div>
                        <input type="file" name="balance_proof[]" multiple class="ea-input"
                               data-preview="balance_proof_preview"/>
                        <ul id="balance_proof_preview" class="text-sm text-gray-600 mt-2 space-y-1"></ul>
                    </div>
                    <div>
                        <div class="ea-label">银行流水（Bank Statement）：</div>
                        <input type="file" name="bank_statement[]" multiple class="ea-input"
                               data-preview="bank_statement_preview"/>
                        <ul id="bank_statement_preview" class="text-sm text-gray-600 mt-2 space-y-1"></ul>
                    </div>
                    <label class="ea-label">学生证 (Student ID Card)：
                        <input type="file" name="student_id" class="ea-input"/>
                    </label>
                    <label class="ea-label">COE：
                        <input type="file" name="coe" class="ea-input"/>
                    </label>
                    <label class="ea-label">水电账单（Bill Receipt）：
                        <input type="file" name="utility_bill" class="ea-input"/>
                    </label>
                    <label class="ea-label">父母支持保证书（Guarantee Letter）：
                        <input type="file" name="guarantee_letter" class="ea-input"/>
                    </label>
                    <div>
                        <div class="ea-label">其他补充材料 ：</div>
                        <input type="file" name="other_files[]" multiple class="ea-input"
                               data-preview="other_files_preview"/>
                        <ul id="other_files_preview" class="text-sm text-gray-600 mt-2 space-y-1"></ul>
                    </div>
                    <div>
                        <div class="ea-label">其他补充材料说明：</div>
                        <textarea name="other_files_notes" rows="2" class="ea-input"
                                  placeholder="租房经历、驾照、资产证明、推荐信等（可附照片/文件）"></textarea>
                    </div>
                </div>
            </div>

            <!-- 工作经历 -->
            <div id="workHistoryContainer" class="ea-section" data-limit="3">
                <h3 class="ea-section-title">五、工作经历 (如有)</h3>
                <div class="form-clone-wrapper space-y-4">
                    <!-- 单条工作记录 -->
                    <div class="form-entry relative space-y-4 border border-gray-300 p-4 rounded-md">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <label class="ea-label">公司名称：
                                <input type="text" name="companyName[]" class="ea-input mt-2"
                                       placeholder="请输入公司名称"/>
                            </label>
                            <label class="ea-label">公司地址：
                                <input type="text" name="companyAddress[]" class="ea-input mt-2"
                                       placeholder="请输入公司地址"/>
                            </label>

                            <label class="ea-label">职位：
                                <input type="text" name="jobPosition[]" class="ea-input"
                                       placeholder="请输入职位"/>
                            </label>
                            <label class="ea-label">收入情况：
                                <input type="text" name="income[]" class="ea-input" placeholder="例如 1000 AUD/Week"/>
                            </label>
                            <div>
                                <div class="ea-label">Duration：</div>
                                <div class="ea-inline-field">
                                    <input type="month" name="rentalStart[]" class="ea-input"/>
                                    <span class="mx-2">至</span>
                                    <input type="month" name="rentalEnd[]" class="ea-input"/>
                                </div>
                            </div>
                            <label class="ea-label">证明人姓名：
                                <input type="text" name="supervisor_name[]" class="ea-input"
                                       placeholder="请输入Full Name"/>
                            </label>
                            <label class="ea-label">证明人职位:
                                <input type="text" name="supervisor_position[]" class="ea-input">
                            </label>
                            <label class="ea-label">证明人电话：
                                <input type="tel" name="supervisor_phone[]" class="ea-input">
                            </label>
                            <label class="ea-label">证明人邮箱:
                                <input type="email" name="supervisor_email[]" class="ea-input">
                            </label>
                            <div>
                                <div class="ea-label">近期3张工资单：</div>
                                <input type="file" name="pay_slips[]" multiple class="ea-input"
                                       data-preview="pay_slips_preview"/>
                                <ul id="pay_slips_preview" class="text-sm text-gray-600 mt-2 space-y-1"></ul>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 添加按钮 -->
                <button type="button" class="ea-add-btn text-blue-600 hover:underline"
                        data-target="#workHistoryContainer">➕ 增加一条工作经历
                </button>
            </div>

            <button type="submit" class="ea-button w-full">
                提交
            </button>
        </form>
    </div>
</main>

<div id="footer" class="mt-12"></div>
</body>
</html>
